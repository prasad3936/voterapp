{% extends "base.html" %}
{% block content %}

<div class="container mt-2">

  <h4 class="fw-bold text-primary mb-3">‡§Æ‡§§‡§¶‡§æ‡§∞ ‡§Ø‡§æ‡§¶‡•Ä</h4>

  <!-- Search + Filter + Pagination -->
  <form method="get" class="row g-2 mb-2 align-items-center">

    <!-- Search -->
    <div class="col-12 col-md-4">
      <input class="form-control"
             name="q"
             value="{{q}}"
             placeholder="‡§®‡§æ‡§µ / EPIC / ‡§™‡§§‡•ç‡§§‡§æ ‡§∂‡•ã‡§ß‡§æ">
    </div>

    <!-- Gender -->
    <div class="col-6 col-md-2">
      <select class="form-select" name="gender">
        <option value="">‡§≤‡§ø‡§Ç‡§ó</option>
        <option value="‡§™‡•Å‡§∞‡•Å‡§∑" {% if gender=='‡§™‡•Å‡§∞‡•Å‡§∑' %}selected{% endif %}>‡§™‡•Å‡§∞‡•Å‡§∑</option>
        <option value="‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä" {% if gender=='‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä' %}selected{% endif %}>‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä</option>
      </select>
    </div>

    <!-- Search Button -->
    <div class="col-6 col-md-2">
      <button class="btn btn-primary w-100 fw-bold">üîç ‡§∂‡•ã‡§ß‡§æ</button>
    </div>

    <!-- Pagination Right (Moves Down on Mobile) -->
    <div class="col-12 col-md-4 text-end mt-1">
      <ul class="pagination pagination-sm justify-content-end mb-0">

        {% if page > 1 %}
        <li class="page-item">
          <a class="page-link"
             href="?page={{page-1}}&q={{q}}&gender={{gender}}">
            ‚¨Ö ‡§Æ‡§æ‡§ó‡•Ä‡§≤
          </a>
        </li>
        {% else %}
        <li class="page-item disabled"><span class="page-link">‚¨Ö ‡§Æ‡§æ‡§ó‡•Ä‡§≤</span></li>
        {% endif %}

        {% for p in range(1, total_pages + 1) %}
        <li class="page-item {% if p == page %}active{% endif %}">
          <a class="page-link"
             href="?page={{p}}&q={{q}}&gender={{gender}}">
            {{p}}
          </a>
        </li>
        {% endfor %}

        {% if page < total_pages %}
        <li class="page-item">
          <a class="page-link"
             href="?page={{page+1}}&q={{q}}&gender={{gender}}">
            ‡§™‡•Å‡§¢‡•Ä‡§≤ ‚û°
          </a>
        </li>
        {% else %}
        <li class="page-item disabled"><span class="page-link">‡§™‡•Å‡§¢‡•Ä‡§≤ ‚û°</span></li>
        {% endif %}

      </ul>
    </div>

  </form>

  <!-- Table -->
  <div class="table-responsive">
    <table class="table table-bordered table-hover bg-white shadow-sm text-center align-middle small">
      <thead class="table-primary text-nowrap">
        <tr>
          <th>‡§´‡•ã‡§ü‡•ã</th>
          <th>‡§®‡§æ‡§µ</th>
          <th>‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï</th>
          <th>EPIC</th>
          <th>‡§ò‡§∞ ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï</th>
          <th>‡§µ‡§Ø</th>
          <th>‡§ï‡§æ‡§∞‡•ç‡§°</th>
        </tr>
      </thead>

      <tbody>
        {% for v in voters %}
        <tr>
          <td><img src="/{{v.photo if v.photo else 'static/photos/default.jpg'}}"
              width="45" height="55" class="rounded"></td>

          <td class="text-start">{{ v.name }}</td>
          <td>{{ v.serial }}</td>
          <td class="text-nowrap">{{ v.epic }}</td>
          <td>{{ v.house }}</td>
          <td>{{ v.age }}</td>

          <td>
            <a class="btn btn-success btn-sm w-100" href="/voter/{{v.id}}">View</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>

{% endblock %}
