name: Keep Render Awake

on:
  schedule:
    - cron: "*/5 * * * *"  # Runs every 5 minutes
  workflow_dispatch:  # Allow manual run

jobs:
  ping:
    runs-on: ubuntu-latest

    steps:
      - name: Curl Render App with Retries and Timestamps
        run: |
          echo "[$(date '+%Y-%m-%d %H:%M:%S %Z')] Starting ping attempts..."
          for i in {1..3}; do
            timestamp=$(date '+%Y-%m-%d %H:%M:%S %Z')
            status=$(curl -s -o /dev/null -w "%{http_code}" https://voteforsumitdhotepatil.onrender.com)
            echo "[$timestamp] Attempt $i: HTTP Status $status"
            if [ "$status" = "200" ]; then
              echo "[$timestamp] Success: Render app is awake."
              break
            else
              echo "[$timestamp] Warning: Received status $status. Retrying in 10 seconds..."
              sleep 10
            fi
          done
       - name: Curl Render App with Retries and Timestamps
        run: |
          echo "[$(date '+%Y-%m-%d %H:%M:%S %Z')] Starting ping attempts..."
          for i in {1..3}; do
            timestamp=$(date '+%Y-%m-%d %H:%M:%S %Z')
            status=$(curl -s -o /dev/null -w "%{http_code}" https://matadar.onrender.com)
            echo "[$timestamp] Attempt $i: HTTP Status $status"
            if [ "$status" = "200" ]; then
              echo "[$timestamp] Success: Render app is awake."
              break
            else
              echo "[$timestamp] Warning: Received status $status. Retrying in 10 seconds..."
              sleep 10
            fi
          done
       - name: Curl Render App with Retries and Timestamps
        run: |
          echo "[$(date '+%Y-%m-%d %H:%M:%S %Z')] Starting ping attempts..."
          for i in {1..3}; do
            timestamp=$(date '+%Y-%m-%d %H:%M:%S %Z')
            status=$(curl -s -o /dev/null -w "%{http_code}" https://matadarweb.onrender.com)
            echo "[$timestamp] Attempt $i: HTTP Status $status"
            if [ "$status" = "200" ]; then
              echo "[$timestamp] Success: Render app is awake."
              break
            else
              echo "[$timestamp] Warning: Received status $status. Retrying in 10 seconds..."
              sleep 10
            fi
          done


